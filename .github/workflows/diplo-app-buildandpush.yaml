name: "Build and push image, deploy to kuber"

on:
  workflow_call:

#    branches:
#    - develop
#  pull_request:
#    branches: [ "main" ]

env:
  BRANCH: develop
  IMAGE_ID: ghcr.io/${{ github.repository_owner }}/diplo-app

jobs:
  build:
    #name: "Build image"
    runs-on: self-hosted
    defaults:
      run:
        shell: bash

    steps:

    - uses: actions/checkout@v3

    - name: Set up Go
      uses: actions/setup-go@v3
      with:
        go-version: 1.20

    - name: Build the Docker image
      run: |-
        docker build . --file Dockerfile --tag  $IMAGE_ID-${GITHUB_REF_NAME}:${GITHUB_SHA} --tag  $IMAGE_ID-${GITHUB_REF_NAME}:latest






